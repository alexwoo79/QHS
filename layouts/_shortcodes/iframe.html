{{- /*
Shortcode to include an iframe with fullscreen capability.

@param {string} url The URL to embed in the iframe.
@param {string} width (Optional) The width of the iframe.
@param {string} height (Optional) The height of the iframe.
@param {string} title (Optional) The title attribute for the iframe.

@example {{< iframe url="https://example.com">}}
  @example {{< iframe url="https://example.com" width="100%" height="400px" title="Example Website">}}
    */ -}}

    {{- $url := .Get "url" -}}
    {{- $width := .Get "width" | default "100%" -}}
    {{- $height := .Get "height" | default "32rem" -}}
    {{- $title := .Get "title" | default "Embedded Content" -}}

    <div class="hextra-iframe" id="hextra-iframe-{{ .Ordinal }}">
      <button class="hextra-iframe-fullscreen-btn" onclick="toggleIframeFullscreen('{{ .Ordinal }}')" title="全屏显示">
        ⛶ 全屏
      </button>
      <iframe src="{{ $url | safeURL }}" width="{{ $width }}" height="{{ $height }}" frameborder="0" allowfullscreen
        title="{{ $title }}"></iframe>
    </div>

    <script>
      function toggleIframeFullscreen(ordinal) {
        const iframeContainer = document.getElementById('hextra-iframe-' + ordinal);

        if (iframeContainer.classList.contains('fullscreen')) {
          // 退出全屏
          iframeContainer.classList.remove('fullscreen');
          document.body.style.overflow = '';
        } else {
          // 进入全屏
          iframeContainer.classList.add('fullscreen');
          document.body.style.overflow = 'hidden';
        }
      }

      // 点击 ESC 退出全屏
      document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
          const fullscreenIframe = document.querySelector('.hextra-iframe.fullscreen');
          if (fullscreenIframe) {
            fullscreenIframe.classList.remove('fullscreen');
            document.body.style.overflow = '';
          }
        }
      });

      // 点击全屏容器外部退出全屏
      document.addEventListener('click', function (e) {
        const fullscreenIframe = document.querySelector('.hextra-iframe.fullscreen');
        if (fullscreenIframe && !fullscreenIframe.contains(e.target)) {
          // 检查点击的是否是全屏按钮
          if (!e.target.classList.contains('hextra-iframe-fullscreen-btn')) {
            fullscreenIframe.classList.remove('fullscreen');
            document.body.style.overflow = '';
          }
        }
      });
    </script>